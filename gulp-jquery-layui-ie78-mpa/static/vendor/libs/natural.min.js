var q={addFavorite:function(o,t){try{window.external.addFavorite(o,t)}catch(e){try{window.sidebar.addPanel(t,o,"")}catch(e){alert("加入收藏失败，请使用Ctrl+D进行添加")}}},setHomepage:function(){if(document.all)document.body.style.behavior="url(#default#homepage)",document.body.setHomePage("http://w3cboy.com");else if(window.sidebar){if(window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){alert("该操作被浏览器拒绝，如果想启用该功能，请在地址栏内输入 about:config,然后将项 signed.applets.codebase_principal_support 值该为true")}Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch).setCharPref("browser.startup.homepage","http://w3cboy.com")}},checkKey:function(e){return 32==e||229==e||(47<e&&e<58||(64<e&&e<91||(95<e&&e<108||(108<e&&e<112||(185<e&&e<193||218<e&&e<223)))))},backTop:function(e){var o=document.getElementById(e),t=document.documentElement,r=document.body;function n(){o.style.display=100<t.scrollTop+r.scrollTop?"block":"none"}window.onscroll=n,o.style.display="none",o.onclick=function(){o.style.display="none",window.onscroll=null,this.timer=setInterval(function(){t.scrollTop-=Math.ceil(.1*(t.scrollTop+r.scrollTop)),r.scrollTop-=Math.ceil(.1*(t.scrollTop+r.scrollTop)),t.scrollTop+r.scrollTop==0&&clearInterval(o.timer,window.onscroll=n)},10)}},openWindow:function(url,windowName,width,height){var x=parseInt(screen.width/2)-width/2,y=parseInt(screen.height/2)-height/2,retval=null,isMSIE="Microsoft Internet Explorer"==navigator.appName;if(isMSIE){var p="resizable=1,location=no,scrollbars=no,width=";p+=width,p+=",height=",p+=height,p+=",left=",p+=x,p+=",top=",p+=y,retval=window.open(url,windowName,p)}else{var win=window.open(url,"ZyiisPopup","top="+y+",left="+x+",scrollbars="+scrollbars+",dialog=yes,modal=yes,width="+width+",height="+height+",resizable=no");eval("try { win.resizeTo(width, height); } catch(e) { }"),win.focus()}},clear_script:function(){K1.value=K1.value.replace(/<script.*?>[\s\S]*?<\/script>|\s+on[a-zA-Z]{3,16}\s?=\s?"[\s\S]*?"|\s+on[a-zA-Z]{3,16}\s?=\s?'[\s\S]*?'|\s+on[a-zA-Z]{3,16}\s?=[^ >]+/gi,"")},javascript:function(){try{eval(K1.value)}catch(e){alert(e.message)}},vbscript:function(){try{var e=document.getElementById("K1").value;if(""==e.trim())return;window.execScript("On Error Resume Next \n"+e+'\n If Err.Number<>0 Then \n MsgBox "请输入正确的VBScript脚本!",48,"脚本错误!" \n End If',"vbscript")}catch(e){alert(e.message)}},getBrowserInfo:function(){var e={},o=window.navigator.userAgent.toLowerCase().match(/(msie|firefox|chrome|opera|version).*?([\d.]+)/);return e.browser=o[1].replace(/version/,"safari"),e.ver=o[2],e}};var browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:-1<e.indexOf("Trident"),presto:-1<e.indexOf("Presto"),webKit:-1<e.indexOf("AppleWebKit"),gecko:-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Adr"),iPhone:-1<e.indexOf("iPhone"),iPad:-1<e.indexOf("iPad"),webApp:-1==e.indexOf("Safari"),weixin:-1<e.indexOf("MicroMessenger"),qq:" qq"==e.match(/\sQQ/i)}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};